# 오늘은  
  
### django 인증 관련 부분을 보려고 했는데  
### 전에 놈들이 어떻게 만들었는지 분석이 안됨  
### oAuth2 로 만든것도 아니고 
### 뭔가 이상한 토큰이 나오긴 하는데 인크립트를  
### 어디서 하는지도 못찾아서 뭘 해야할지 모르겠음  
  
  
## 그러니까 그냥 앞으로 개발 할 것에 대한 설계를 해보겠음  
  ```
 개발판은 가끔 유행에 엄청 휩쓸리는 경향이 있는데  
오래는 아니고 얼마전쯤 까지 MSA가 엄청 유행을 했었음  
MSA는 Micro Service Architecture 라고 
서비스를 작은 단위로 쪼개서 개발 하는것이다.
예를들어 auth, payment, board 등이 각각 따로 개발되고
따로 배포 되도록 만드는 것 인데, 이렇게 나눠질 경우 
여러가지 장점이 존재 한다.

1. 빠른 개발. 
각각 작은 서비스 단위로 개발 하기 때문에 빠른 개발이 가능하다.

2. 폭넓은 기술 선택
각각 다른 서비스 이기 때문에 다른 기술 스텍을 가져갈 수 있다.

3. 빠른 배포
서비스 단위로 배포가 가능하기 때문에 빠른 배포가 가능하다.

4. 서비스 별 스케일 아웃
트래픽이 몰리는 쪽만 스케일 아웃 하여 코스트 절감 가능

등이 있고 단점으로는

1. 개발 환경 구성 어려움
MSA로 된 개발환경을 전부 구성하기 귀찮아 진다.

2. 테스트의 어려움
위에서 연결되는 말로 각각의 테스트는 가능하나 다른 서비스들과
연계해서 테스트 하기 복잡해진다.

3. 트렌젝션의 어려움
각 서비스들이 독립적으로 돌아가기 때문에 트렌젝션 하기 어려워진다

등등등이 있다..


현재 A,B,C 서비스를 동시에 하고 있는 우리 회사에선

A,B,C 서비스 각각이 모놀리식 서비스 이고 약간씩 다르긴 하지만 크게는

Front : react.js
Back : django 

로 구성되어있다. 앞으로의 비니지스 모델 상 세 서비스가 연계되어야 하고

그러기 위해서 모놀리식을 계속 가져가는 것 보다 미래를 위해 적어도 auth 부분

정도는 따로 분리 해놔야 정신건강에 좋을 것 같다.

그 이유는 A,B,C 모두 연동이 되어야 하며 그러기 위해선 A,B,C 전부 

회원 정보를 가지고 있거나 매번 로그인 할 때 마다 전부 한번씩 유저를 확인해야한다

그것 보단 auth 부분만 따로 떼서 필요한 정보를 전부 저장하고 한번에 로그인이

되게끔 개발 하는게 맞는 것 같다. 



1. auth server 구축

2. A,B,C 로그인 정보 이전

3. 로그인 시도 시 각 도메인을 확인 하고 도메인에 맞는 로그인 정보 검색

4. 로그인 시 각 도메인에 맞는 토큰 발급

5. 연동 테이블 생성

6. 서비스 이동 시 연동 테이블 확인 후 연동된 정보 확인 

7. 미연동 시 연동 시도 서비스 로그인 시도 하게 함

8. 로그인 성공 시 연동 테이블에 기록

9. 연동된 아이디가 있을 시 해당 서비스 토큰 발행


대충 이런식으로 로직이면 될것 같은데

내부 소스를 더 까봐야 이게 가능할지 알 것 같다.

 

```